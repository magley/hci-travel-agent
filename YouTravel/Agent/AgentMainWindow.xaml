<Window x:Class="YouTravel.Agent.AgentMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:YouTravel.Agent"
        mc:Ignorable="d"
		Style="{StaticResource WinDark}"
        Title="YouTravel Agent" Width="960" Height="600"
		Loaded="Window_Loaded">

	<Window.Resources>
		<BitmapImage x:Key="IcoAdd" UriSource="../Res/IcoAdd.png"/>
		<BitmapImage x:Key="IcoEdit" UriSource="../Res/IcoPencil.png"/>
		<BitmapImage x:Key="IcoStats" UriSource="../Res/IcoChart.png"/>
		<BitmapImage x:Key="IcoMagnifier" UriSource="../Res/IcoMagnifier.png"/>

		<BitmapImage x:Key="IcoAddPlace" UriSource="../Res/IcoLocationAdd.png"/>
		<BitmapImage x:Key="IcoAddArrangement" UriSource="../Res/IcoPlanetAdd.png"/>
		<BitmapImage x:Key="IcoArrangement" UriSource="../Res/IcoTravel.png"/>
		<BitmapImage x:Key="IcoPlace" UriSource="../Res/IcoLocation.png"/>
	</Window.Resources>

	<Window.CommandBindings>
		<CommandBinding Command="{x:Static local:Command.CmdCloseCurrentTab}" Executed="CmdCloseCurrentTab_Executed" CanExecute="CmdCloseCurrentTab_CanExecute"/>
	</Window.CommandBindings>

	<DockPanel>
		<StackPanel DockPanel.Dock="Top">
			<Menu>
				<MenuItem Header="_File">
					<MenuItem Header="New">
						<MenuItem Header="Arrangement">
							<MenuItem.Icon>
								<Image Source="{StaticResource IcoAddArrangement}"/>
							</MenuItem.Icon>
						</MenuItem>
						<MenuItem Header="Place" Click="On_AddPlace">
							<MenuItem.Icon>
								<Image Source="{StaticResource IcoAddPlace}"/>
							</MenuItem.Icon>
						</MenuItem>
					</MenuItem>
					<Separator/>
					<MenuItem Header="Logout"></MenuItem>
					<MenuItem Header="Exit"></MenuItem>
				</MenuItem>
				<MenuItem Header="_View">
					<MenuItem Header="Arrangements" Click="On_OpenArrangementList">
						<MenuItem.Icon>
							<Image Source="{StaticResource IcoArrangement}"/>
						</MenuItem.Icon>
					</MenuItem>
					<MenuItem Header="Places" Click="On_OpenPlaceList">
						<MenuItem.Icon>
							<Image Source="{StaticResource IcoPlace}"/>
						</MenuItem.Icon>
					</MenuItem>
					<MenuItem Header="Monthly Reports"></MenuItem>
					<Separator/>
					<MenuItem Header="Show Toolbar" IsCheckable="True" Click="ShowToolbar_Click" IsChecked="{Binding Path=ToolbarVisible}"></MenuItem>
				</MenuItem>
				<MenuItem Header="_Settings">
					<MenuItem Header="Preferences" Click="On_OpenSettings"/>
					<MenuItem Header="Customize Toolbar" Click="On_OpenSettings_Toolbar"/>
				</MenuItem>
				<MenuItem Header="_Help">
					<MenuItem Header="About YouTravel"></MenuItem>
					<MenuItem Header="Help"></MenuItem>
				</MenuItem>
			</Menu>
			<ToolBarTray x:Name="toolbarTray">
				<ToolBar Template="{StaticResource ToolBarTemplate1}" Band="0" >
					<Button>
						<Image Source="{StaticResource IcoAddArrangement}" Height="20"/>
					</Button>
					<Button Click="On_AddPlace">
						<Image Source="{StaticResource IcoAddPlace}" Height="20"/>
					</Button>
				</ToolBar>
			</ToolBarTray>
		</StackPanel>

		<TabControl DockPanel.Dock="Bottom" ItemsSource="{Binding UserControls}" x:Name="MyTabControl">
				<TabControl.InputBindings>
					<KeyBinding Key="W" Modifiers="Ctrl" Command="{x:Static local:Command.CmdCloseCurrentTab}" />
				</TabControl.InputBindings>
			
				<TabControl.ItemTemplate>
				<DataTemplate DataType="local:MyTab">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>
						<TextBlock Grid.Column="0" Text="{Binding Name}"/>
						<Button Grid.Column="1" Click="TabClose_Click" CommandParameter="{Binding Name}">
							<Button.Template>
								<ControlTemplate TargetType="Button">
									<Path Data="M0,0 L8,8 M8,0 L0,8" StrokeThickness="3" VerticalAlignment="Center" Margin="9,4,0,2" Stroke="WhiteSmoke"/>
								</ControlTemplate>
							</Button.Template>
						</Button>
					</Grid>
				</DataTemplate>
			</TabControl.ItemTemplate>
			
			<TabControl.ContentTemplate>
				<DataTemplate DataType="local:MyTab">
					<ContentControl Content="{Binding UserControl}"/>
				</DataTemplate>
			</TabControl.ContentTemplate>
		</TabControl>
	</DockPanel>
</Window>
